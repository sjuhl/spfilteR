<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Unsupervised Spatial Filtering with Eigenvectors in Generalized
Linear Regression Models — glmFilter • spfilteR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Unsupervised Spatial Filtering with Eigenvectors in Generalized
Linear Regression Models — glmFilter"><meta property="og:description" content="This function implements the eigenvector-based semiparametric
spatial filtering approach in a generalized linear regression framework using
maximum likelihood estimation (MLE). Eigenvectors are selected by an unsupervised
stepwise regression technique. Supported selection criteria are the minimization of
residual autocorrelation, maximization of model fit, significance of residual
autocorrelation, and the statistical significance of eigenvectors. Alternatively,
all eigenvectors in the candidate set can be included as well."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spfilteR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/spfilteR_vignette.html">spfilteR: Spatial Filtering with Eigenvectors</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sjuhl/spfilteR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Unsupervised Spatial Filtering with Eigenvectors in Generalized
Linear Regression Models</h1>
    <small class="dont-index">Source: <a href="https://github.com/sjuhl/spfilteR/blob/HEAD/R/glmFilter.R" class="external-link"><code>R/glmFilter.R</code></a></small>
    <div class="hidden name"><code>glmFilter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function implements the eigenvector-based semiparametric
spatial filtering approach in a generalized linear regression framework using
maximum likelihood estimation (MLE). Eigenvectors are selected by an unsupervised
stepwise regression technique. Supported selection criteria are the minimization of
residual autocorrelation, maximization of model fit, significance of residual
autocorrelation, and the statistical significance of eigenvectors. Alternatively,
all eigenvectors in the candidate set can be included as well.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">glmFilter</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">W</span>,</span>
<span>  objfn <span class="op">=</span> <span class="st">"AIC"</span>,</span>
<span>  MX <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  optim.method <span class="op">=</span> <span class="st">"BFGS"</span>,</span>
<span>  sig <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  bonferroni <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  positive <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ideal.setsize <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  min.reduction <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  boot.MI <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  resid.type <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>y</dt>
<dd><p>response variable</p></dd>


<dt>x</dt>
<dd><p>vector/ matrix of regressors (default = NULL)</p></dd>


<dt>W</dt>
<dd><p>spatial connectivity matrix</p></dd>


<dt>objfn</dt>
<dd><p>the objective function to be used for eigenvector
selection. Possible criteria are: the maximization of model fit
('AIC' or 'BIC'), minimization of residual autocorrelation ('MI'),
significance level of candidate eigenvectors ('p'), significance of residual spatial
autocorrelation ('pMI'), or all eigenvectors in the candidate set ('all')</p></dd>


<dt>MX</dt>
<dd><p>covariates used to construct the projection matrix (default = NULL) - see
Details</p></dd>


<dt>model</dt>
<dd><p>a character string indicating the type of model to be estimated.
Currently, 'probit', 'logit', and 'poisson' are valid inputs</p></dd>


<dt>optim.method</dt>
<dd><p>a character specifying the optimization method used by
the <code>optim</code> function</p></dd>


<dt>sig</dt>
<dd><p>significance level to be used for eigenvector selection
if <code>objfn = 'p'</code> or <code>objfn = 'pMI'</code></p></dd>


<dt>bonferroni</dt>
<dd><p>Bonferroni adjustment for the significance level
(TRUE/ FALSE) if <code>objfn = 'p'</code>. Set to FALSE if <code>objfn = 'pMI'</code> -
see Details</p></dd>


<dt>positive</dt>
<dd><p>restrict search to eigenvectors associated with positive
levels of spatial autocorrelation (TRUE/ FALSE)</p></dd>


<dt>ideal.setsize</dt>
<dd><p>if <code>positive = TRUE</code>, uses the formula proposed by
Chun et al. (2016) to determine the ideal size of the candidate set
(TRUE/ FALSE)</p></dd>


<dt>min.reduction</dt>
<dd><p>if <code>objfn</code> is either 'AIC' or 'BIC'. A value in the
interval [0,1) that determines the minimum reduction in AIC/ BIC (relative to the
current AIC/ BIC) a candidate eigenvector need to achieve in order to be selected</p></dd>


<dt>boot.MI</dt>
<dd><p>number of iterations used to estimate the variance of Moran's I
(default = 100). Alternatively, if <code>boot.MI = NULL</code>, analytical results will
be used</p></dd>


<dt>resid.type</dt>
<dd><p>character string specifying the residual type to be used.
Options are 'raw', 'deviance', and 'pearson' (default)</p></dd>


<dt>alpha</dt>
<dd><p>a value in (0,1] indicating the range of candidate eigenvectors
according to their associated level of spatial autocorrelation, see e.g.,
Griffith (2003)</p></dd>


<dt>tol</dt>
<dd><p>if <code>objfn = 'MI'</code>, determines the amount of remaining residual
autocorrelation at which the eigenvector selection terminates</p></dd>


<dt>na.rm</dt>
<dd><p>remove observations with missing values (TRUE/ FALSE)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>spfilter</code> containing the following
information:</p><dl><dt><code>estimates</code></dt>
<dd><p>summary statistics of the parameter estimates</p></dd>

<dt><code>varcovar</code></dt>
<dd><p>estimated variance-covariance matrix</p></dd>

<dt><code>EV</code></dt>
<dd><p>a matrix containing the summary statistics of selected eigenvectors</p></dd>

<dt><code>selvecs</code></dt>
<dd><p>vector/ matrix of selected eigenvectors</p></dd>

<dt><code>evMI</code></dt>
<dd><p>Moran coefficient of all eigenvectors</p></dd>

<dt><code>moran</code></dt>
<dd><p>residual autocorrelation in the initial and the
filtered model</p></dd>

<dt><code>fit</code></dt>
<dd><p>adjusted R-squared of the initial and the filtered model</p></dd>

<dt><code>residuals</code></dt>
<dd><p>initial and filtered model residuals</p></dd>

<dt><code>other</code></dt>
<dd><p>a list providing supplementary information:</p><dl><dt><code>ncandidates</code></dt>
<dd><p>number of candidate eigenvectors considered</p></dd>

<dt><code>nev</code></dt>
<dd><p>number of selected eigenvectors</p></dd>

<dt><code>condnum</code></dt>
<dd><p>condition number to assess the degree of multicollinearity
among the eigenvectors induced by the link function, see e.g., Griffith/ Amrhein
(1997)</p></dd>

<dt><code>sel_id</code></dt>
<dd><p>ID of selected eigenvectors</p></dd>

<dt><code>sf</code></dt>
<dd><p>vector representing the spatial filter</p></dd>

<dt><code>sfMI</code></dt>
<dd><p>Moran coefficient of the spatial filter</p></dd>

<dt><code>model</code></dt>
<dd><p>type of the regression model</p></dd>

<dt><code>dependence</code></dt>
<dd><p>filtered for positive or negative spatial dependence</p></dd>

<dt><code>objfn</code></dt>
<dd><p>selection criterion specified in the objective function of
the stepwise regression procedure</p></dd>

<dt><code>bonferroni</code></dt>
<dd><p>TRUE/ FALSE: Bonferroni-adjusted significance level
(if <code>objfn='p'</code>)</p></dd>

<dt><code>siglevel</code></dt>
<dd><p>if <code>objfn = 'p'</code> or <code>objfn = 'pMI'</code>: actual
(unadjusted/ adjusted) significance level</p></dd>

<dt><code>resid.type</code></dt>
<dd><p>residual type ('raw', 'deviance', or 'pearson')</p></dd>

<dt><code>pseudoR2</code></dt>
<dd><p>McFadden's pseudo R-squared (filtered vs. unfiltered model)</p></dd>


</dl></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If <strong>W</strong> is not symmetric, it gets symmetrized by
1/2 * (<strong>W</strong> + <strong>W</strong>') before the decomposition.</p>
<p>If covariates are supplied to <code>MX</code>, the function uses these regressors
to construct the following projection matrix:</p>
<p><strong>M</strong> = <strong>I</strong> - <strong>X</strong> (<strong>X</strong>'<strong>X</strong>)^-1<strong>X</strong>'</p>
<p>Eigenvectors from <strong>MWM</strong> using this specification of
<strong>M</strong> are not only mutually uncorrelated but also orthogonal
to the regressors specified in <code>MX</code>. Alternatively, if <code>MX = NULL</code>, the
projection matrix becomes <strong>M</strong> = <strong>I</strong> - <strong>11</strong>'/ *n*,
where <strong>1</strong> is a vector of ones and *n* represents the number of
observations. Griffith and Tiefelsdorf (2007) show how the choice of the appropriate
<strong>M</strong> depends on the underlying process that generates the spatial
dependence.</p>
<p>The Bonferroni correction is only possible if eigenvector selection is based on
the significance level of the eigenvectors (<code>objfn = 'p'</code>). It is set to
FALSE if eigenvectors are added to the model until the residuals exhibit no
significant level of spatial autocorrelation (<code>objfn = 'pMI'</code>).</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>If the condition number (<code>condnum</code>) suggests high levels of
multicollinearity, eigenvectors can be sequentially removed from <code>selvecs</code>
and the model can be re-estimated using the <code>glm</code> function in order to
identify and manually remove the problematic eigenvectors. Moreover, if other
models that are currently not implemented here need to be estimated
(e.g., quasi-binomial models), users can extract eigenvectors using the function
<code>getEVs</code> and perform a supervised eigenvector search using the <code>glm</code>
function.</p>
<p>In contrast to eigenvector-based spatial filtering in linear regression models,
Chun (2014) notes that only a limited number of studies address the problem
of measuring spatial autocorrelation in generalized linear model residuals.
Consequently, eigenvector selection may be based on an objective function that
maximizes model fit rather than minimizes residual spatial autocorrelation.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Chun, Yongwan (2014): Analyzing Space-Time Crime Incidents Using
Eigenvector Spatial Filtering: An Application to Vehicle Burglary.
Geographical Analysis 46 (2): pp. 165 - 184.</p>
<p>Tiefelsdorf, Michael and Daniel A. Griffith (2007):
Semiparametric filtering of spatial autocorrelation: the eigenvector
approach. Environment and Planning A: Economy and Space, 39 (5):
pp. 1193 - 1221.</p>
<p>Griffith, Daniel A. (2003): Spatial Autocorrelation and Spatial Filtering:
Gaining Understanding Through Theory and Scientific Visualization.
Berlin/ Heidelberg, Springer.</p>
<p>Griffith, Daniel A. and Carl G. Amrhein (1997): Multivariate Statistical
Analysis for Geographers. Englewood Cliffs, Prentice Hall.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="lmFilter.html">lmFilter</a></code>, <code><a href="getEVs.html">getEVs</a></code>, <code><a href="MI.resid.html">MI.resid</a></code>,
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fakedata</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># poisson model</span></span></span>
<span class="r-in"><span><span class="va">y_pois</span> <span class="op">&lt;-</span> <span class="va">fakedataset</span><span class="op">$</span><span class="va">count</span></span></span>
<span class="r-in"><span><span class="va">poisson</span> <span class="op">&lt;-</span> <span class="fu">glmFilter</span><span class="op">(</span>y <span class="op">=</span> <span class="va">y_pois</span>, x <span class="op">=</span> <span class="cn">NULL</span>, W <span class="op">=</span> <span class="va">W</span>, objfn <span class="op">=</span> <span class="st">"MI"</span>, positive <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>model <span class="op">=</span> <span class="st">"poisson"</span>, boot.MI <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">poisson</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 out of 31 candidate eigenvectors selected</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">poisson</span>, EV <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	- Spatial Filtering with Eigenvectors (Poisson Model)  -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients (ML):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate         SE      p-value    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 2.528379 0.02829935 1.032215e-95 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Fit:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          logL      AIC      BIC     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial  -1688.207 3378.415 3381.02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filtered -1683.523 3371.047 3376.257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filtered for positive spatial autocorrelation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 out of 31 candidate eigenvectors selected</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Condition Number (Multicollinearity): 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Objective Function: "MI"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Moran's I (PearsonResiduals):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Observed    Expected    Variance        z   p-value  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial  0.1144870 -0.01010101 0.009277738 1.293466 0.1386139  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filtered 0.1075435 -0.01868546 0.005490931 1.703476 0.1386139  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># probit model - summarize EVs</span></span></span>
<span class="r-in"><span><span class="va">y_prob</span> <span class="op">&lt;-</span> <span class="va">fakedataset</span><span class="op">$</span><span class="va">indicator</span></span></span>
<span class="r-in"><span><span class="va">probit</span> <span class="op">&lt;-</span> <span class="fu">glmFilter</span><span class="op">(</span>y <span class="op">=</span> <span class="va">y_prob</span>, x <span class="op">=</span> <span class="cn">NULL</span>, W <span class="op">=</span> <span class="va">W</span>, objfn <span class="op">=</span> <span class="st">"p"</span>, positive <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>model <span class="op">=</span> <span class="st">"probit"</span>, boot.MI <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">probit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 out of 31 candidate eigenvectors selected</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">probit</span>, EV <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	- Spatial Filtering with Eigenvectors (Probit Model)  -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients (ML):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate        SE    p-value  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 0.3054679 0.1274797 0.01844387 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Fit:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          logL      AIC      BIC    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial  -66.40641 134.8128 137.418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filtered -66.40641 134.8128 137.418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filtered for positive spatial autocorrelation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 out of 31 candidate eigenvectors selected</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Objective Function: "p" (significance level = 0.05)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bonferroni correction: TRUE (adjusted significance level = 0.00161)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No eigenvectors selected</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Moran's I (PearsonResiduals):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Observed    Expected    Variance         z   p-value  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial  -0.001603494 -0.01010101 0.005313314 0.1165760 0.4554455  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filtered -0.001603494 -0.01010101 0.005090829 0.1190962 0.5841584  </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># logit model - AIC objective function</span></span></span>
<span class="r-in"><span><span class="va">y_logit</span> <span class="op">&lt;-</span> <span class="va">fakedataset</span><span class="op">$</span><span class="va">indicator</span></span></span>
<span class="r-in"><span><span class="va">logit</span> <span class="op">&lt;-</span> <span class="fu">glmFilter</span><span class="op">(</span>y <span class="op">=</span> <span class="va">y_logit</span>, x <span class="op">=</span> <span class="cn">NULL</span>, W <span class="op">=</span> <span class="va">W</span>, objfn <span class="op">=</span> <span class="st">"AIC"</span>, positive <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>model <span class="op">=</span> <span class="st">"logit"</span>, min.reduction <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">logit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 out of 31 candidate eigenvectors selected</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">logit</span>, EV <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	- Spatial Filtering with Eigenvectors (Logit Model)  -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients (ML):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate        SE    p-value  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 0.4895482 0.2060214 0.01941604 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Fit:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          logL      AIC      BIC    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial  -66.40641 134.8128 137.418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filtered -66.40641 134.8128 137.418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filtered for positive spatial autocorrelation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 out of 31 candidate eigenvectors selected</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Objective Function: "AIC"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Moran's I (PearsonResiduals):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Observed    Expected    Variance         z   p-value  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial  -0.001603471 -0.01010101 0.005213413 0.1176880 0.5346535  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Filtered -0.001603471 -0.01010101 0.006622039 0.1044233 0.4950495  </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Juhl.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

